/*! PhotoZoom - jQuery Plugin - 0.2.0 - 2014-03-17 | https://github.com/PizzaBrandon/photozoom
 * Copyright (c) 2014 by Brandon Belvin | Released under the MIT License | http://brandon.mit-license.org */
(function(f,p){var m=function(e){var b=this,k=e.zoomContainer,h=e.image,a,c;f("#photozoomLens").remove();c=f('<div id="photozoomLens" class="photozoomLens"/>').css({position:"absolute",background:"#fff",border:"2px solid #333",opacity:0.5,display:"none",cursor:"pointer"}).appendTo(h);b.resize=function(){var g=k.zoomRatio||0.25,d=k.zoomBoundary;a={width:Math.round(Math.min(h.width(),d.width*g)),height:Math.round(Math.min(h.height(),d.height*g))};c.css(a);return b};f(document).on("photozoom.imageready",
b.resize);b.moveLens=function(b){if(c){var d=b.x;b=b.y;d=d<a.width/2?0:d>h.width()-a.width/2?h.width()-a.width:d-a.width/2;b=b<a.height/2?0:b>h.height()-a.height/2?h.height()-a.height:b-a.height/2;d={left:d,top:b};c.css(d);return d}};e.pos&&b.moveLens(e.pos);b.show=function(){c&&c.show();return b};b.hide=function(){c&&c.hide();return b};b.destroy=function(){c&&c.remove();c=null;f(document).off("photozoom.imageready");return b};b.element=function(){return c}},n=function(e){var b=this,k=e.image,h=e.target;
e=e.zoomImage;var a,c,g;f("#photozoomContainer").remove();a=f('<div id="photozoomContainer" class="photozoomContainer"/>').css({position:"absolute",background:"#fff",overflow:"hidden",display:"none"}).appendTo(document.body);b.resize=function(){var d=f(h),c=f(p),d={left:d.offset().left,top:d.offset().top,right:d.offset().left+d.outerWidth(),bottom:d.offset().top+d.outerHeight()};d.top=Math.max(d.top,c.scrollTop());d.bottom=Math.min(d.bottom,c.scrollTop()+c.height());d.width=d.right-d.left;d.height=
d.bottom-d.top;c=b.zoomBoundary=d;a.css({top:c.top,left:c.left,width:c.width,height:c.height});return b};c=new Image;c.onload=function(){b.zoomRatio=k.width()/c.width;b.resize();f(document).trigger("photozoom.imageready")};c.src=e;g=f('<img id="photozoomImage" class="photozoomImage"/>').attr("src",e).css({position:"absolute"}).appendTo(a);b.moveImage=function(a){g.css({top:-a.top/b.zoomRatio,left:-a.left/b.zoomRatio});return b};b.show=function(){a&&a.show();return b};b.hide=function(){a&&a.hide();
return b};b.destroy=function(){g.remove();g=null;a.remove();a=null;return b}},q=function(e){var b=this,k=e.image,h=f(e.gallery);h.find("[data-photozoom-gallery]").on("click.photozoom",function(a){a.preventDefault();a=f(a.currentTarget).data();k.switchImage(a.src,a.zoomSrc)});b.destroy=function(){h.find("[data-photozoom-gallery]").off("click.photozoom");h=null;return b};return b};f.fn.photozoom=function(e){function b(a){if(!c)if(c=a||!0,g.resize().show(),d.resize().show(),a)f(document).on("touchmove.photozoom",
h).on("touchend.photozoom",k);else f(document).on("mousemove.photozoom",h),d.element().on("mouseout.photozoom",k)}function k(){c&&(d.hide(),g.hide(),f(document).off("touchmove.photozoom touchend.photozoom mousemove.photozoom"),d.element().off("mouseout.photozoom"),c=!1)}function h(c){var e=c.originalEvent.touches?c.originalEvent.touches[0]:c.originalEvent.changedTouches?c.originalEvent.changedTouches[0]:null;e?(c.preventDefault(),b("touch"),c=e):b();c={x:c.pageX-a.offset().left,y:c.pageY-a.offset().top};
c=d.moveLens(c);g.moveImage(c)}var a=this,c=!1;e=f.extend({clipToBoundaries:!0,target:"#photozoomWindow",gallery:"#photozoomGallery"},e);var g=a.zoomContainer=new n({image:a,target:e.target,zoomImage:a.data().zoomSrc}),d=a.lens=new m({image:a,zoomContainer:g}),l=a.gallery=new q({image:a,gallery:e.gallery});a.on("touchstart.photozoom mouseover.photozoom",h);a.switchImage=function(b,c){var f=a.find("img");f.attr("src")!==b&&(k(),g.destroy(),d.destroy(),f.attr("src",b),g=a.zoomContainer=new n({image:a,
target:e.target,zoomImage:c}),d=a.lens=new m({image:a,zoomContainer:g}))};a.destroy=function(){d&&(d.destroy(),d=null);g&&(g.destroy(),g=null);l&&(l.destroy(),l=null);a=null;a.off("touchstart.photozoom touchmove.photozoom mousemove.photozoom mouseout.photozoom touchend.photozoom");return a};return a}})(jQuery,window);
